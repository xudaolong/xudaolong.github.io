{"posts":[{"title":"React hooks å…¥é—¨å’Œè¿›é˜¶","text":"React hookså¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§,å®ƒçš„å‡ºç°æä¾›äº†ä¸€ç§æ–°å‹å¯å¤ç”¨ç»„ä»¶é—´çŠ¶æ€é€»è¾‘çš„é€”å¾„,æ›¿æ¢ä»¥å¾€é‡‡ç”¨çš„HOCå’ŒRender Propsçš„å½¢å¼. æ–°å¢è¯¥ç‰¹æ€§çš„åŸç”±: https://zh-hans.reactjs.org/docs/hooks-intro.html#motivation ğŸ¶ ç‰¹æ€§ å¤šä¸ªçŠ¶æ€ä¸ä¼šäº§ç”ŸåµŒå¥—ï¼Œå†™æ³•è¿˜æ˜¯å¹³é“ºçš„ï¼ˆrenderProps å¯ä»¥é€šè¿‡ compose è§£å†³ï¼Œå¯ä¸ä½†ä½¿ç”¨ç•¥ä¸ºç¹çï¼Œè€Œä¸”å› ä¸ºå¼ºåˆ¶å°è£…ä¸€ä¸ªæ–°å¯¹è±¡è€Œå¢åŠ äº†å®ä½“æ•°é‡ï¼‰ã€‚ Hooks å¯ä»¥å¼•ç”¨å…¶ä»– Hooksã€‚ æ›´å®¹æ˜“å°†ç»„ä»¶çš„ UI ä¸çŠ¶æ€åˆ†ç¦»ã€‚ â€“ ç²¾è¯»ã€ŠReact Hooksã€‹ React hookså¸¦æ¥äº†æ›´å¼ºçš„ç»„åˆè®¾è®¡æ¨¡å¼, ä¸çŠ¶æ€çš„éš”ç¦»æ›´åŠ æ¸…æ™°. ğŸ·ç”Ÿå‘½å‘¨æœŸReact hooksçš„ç”Ÿå‘½å‘¨æœŸ React class componentçš„ç”Ÿå‘½å‘¨æœŸ ç›¸æ¯”class component, ä»…ç¼ºå°‘å¯¹äºä¸å¸¸è§çš„ getSnapshotBeforeUpdate å’Œ componentDidCatch, å…¶ä»–çš„é˜¶æ®µéƒ½æœ‰å¯¹åº”ç­‰ä»·å…³ç³». ğŸ‘ React hooks1. ä½¿ç”¨useState1const [state, setState] = useState(initialState); 1.1 initialStateä»…åˆæ¬¡æ¸²æŸ“èµ·ä½œç”¨,å¾€åçš„æ¸²æŸ“è¢«å¿½ç•¥ è‹¥initialStateæ˜¯ä¸€ä¸ªå‡½æ•°, åˆ™åœ¨åˆå§‹æ¸²æŸ“æ—¶è°ƒç”¨å¹¶è¿”å›ç»“æœ 1.2 stateæ­¤æ—¶stateç­‰ä»·äºinitialState 1.3 setStateæä¾›ç»™æ›´æ–°stateä½¿ç”¨çš„å‡½æ•°ã€‚ å› ä¸ºsetStateæ˜¯ä¸å¯å˜çš„, æ•…å¯åœ¨ä½¿ç”¨useEffectå’ŒuseCallbackä¾èµ–åˆ—è¡¨ä¸­çœç•¥setStateå…¶ä¸classä¸­çš„setStateæ–¹æ³•ä¸åŒ, ä¸èƒ½è‡ªåŠ¨åˆå¹¶æ›´æ–°å¯¹è±¡ 1234setState(prevState =&gt; { // ä¹Ÿå¯ä»¥ä½¿ç”¨ Object.assign return {...prevState, ...updatedValues};}); 2. ä½¿ç”¨useEffectuseEffectç›¸ä¼¼ç­‰ä»·äºcomponentDidMount, componentDidUpdate , componentWillUnmount, ä»¥ä¸‹å±•ç¤ºä¸‰ä¸ªåœºæ™¯ 2.1 æ¯æ¬¡æ¸²æŸ“123React.useEffect( () =&gt; { Console.log(&quot;useEffect runs&quot;);}); 2.2 ä»…å½“ä¾èµ–æ”¹å˜æ—¶æ¸²æŸ“123React.useEffect( () =&gt; { Console.log(&quot;useEffect runs&quot;);}, [state]); 2.3 ç»„ä»¶é”€æ¯æ—¶12345678useEffect(() =&gt; { console.log('mounted'); const subscription = props.source.subscribe(); return () =&gt; { console.log('unmounting...'); subscription.unsubscribe(); }}, []) // [] ç©ºæ•°ç»„ä»£è¡¨æ­¤effectä»…åœ¨ mounted å’Œ unmounting è°ƒç”¨ä¸€æ¬¡ å»ºè®®ä½¿ç”¨ eslint-plugin-react-hooks å’Œ exhaustive-deps é…åˆä½¿ç”¨ ä½†useEffectåˆä¸componentDidMountã€componentDidUpdateä¸åŒ, å¦‚ä¸‹å›¾æ‰€ç¤º, useEffectæ˜¯åœ¨browser paints screenæ›´æ–°åè¿›è¡Œå»¶è¿Ÿå¤„ç†æ“ä½œçš„ã€‚ ä½†ä¸æ˜¯æ‰€æœ‰çš„effectéƒ½éœ€è¦å»¶è¿Ÿ, åƒå¤„ç†domç­‰æ“ä½œæ—¶, åº”è¯¥åœ¨browser paints screenå‰å°±è¦å¤„ç†å®Œæˆ, è¿™æ—¶å°±éœ€è¦ä½¿ç”¨ useLayoutEffects, å¦åˆ™å°±ä¼šäº§ç”Ÿè§†è§‰çš„çªå…€æ„Ÿ, åæ­£è®°ç€ä¼˜å…ˆä½¿ç”¨useEffect, è‹¥å¤„ç†ä¸­é‡åˆ°å¼‚å¸¸åˆ™ä½¿ç”¨ useLayoutEffect, è§ä¸‹é¢. 3. ä½¿ç”¨useContextuseContext(MyContext) ç­‰ä»·äº class ä¸­çš„ static contextType = MyContext æˆ– &lt;MyContext.Consumer&gt; 12345678910111213141516171819202122import React, { useContext } from &quot;react&quot;;import ReactDOM from &quot;react-dom&quot;;import &quot;./styles.css&quot;;const Context = React.createContext();function Display() { const value = useContext(Context); return &lt;div&gt;{value}, I am your Father.&lt;/div&gt;;}function App() { return ( &lt;Context.Provider value={&quot;Luke&quot;}&gt; &lt;Display /&gt; &lt;/Context.Provider&gt; );}const rootElement = document.getElementById(&quot;root&quot;);ReactDOM.render(&lt;App /&gt;, rootElement); 4. ä½¿ç”¨useReduceruseStateçš„åŠ å¼ºç‰ˆ, å¯ä»£æ›¿å»å¤„ç†å¤æ‚æ·±å±‚ç»“æ„çš„state, æœ¬è´¨å°±æ˜¯ä½¿ç”¨ dispatch æ›¿æ¢ callback å±€éƒ¨çŠ¶æ€ä¸æ¨èä½¿ç”¨ useReducer , ä¼šå¯¼è‡´å‡½æ•°å†…éƒ¨æ›´å¤æ‚, éš¾ä»¥é˜…è¯», åœ¨å¤šç»„ä»¶é€šä¿¡æ—¶å¯ç»“åˆ useContextä¸€èµ·ä½¿ç”¨ 1234567891011121314151617181920212223const initialState = {count: 0};function reducer(state, action) { switch (action.type) { case 'increment': return {count: state.count + 1}; case 'decrement': return {count: state.count - 1}; default: throw new Error(); }}function Counter() { const [state, dispatch] = useReducer(reducer, initialState); return ( &lt;&gt; Count: {state.count} &lt;button onClick={() =&gt; dispatch({type: 'decrement'})}&gt;-&lt;/button&gt; &lt;button onClick={() =&gt; dispatch({type: 'increment'})}&gt;+&lt;/button&gt; &lt;/&gt; );} 4.1 initialStateæ­¤æ—¶stateç­‰ä»·äºinitialState æƒ°æ€§åˆå§‹åŒ– 12345function init(initialState) { return {count: initialState};}const [state, dispatch] = useReducer(reducer, initialState, init); 5. ä½¿ç”¨useCallbackuseCallback(fn, deps) ç­‰ä»·äº useMemo(() =&gt; fn, deps), åˆå§‹åŒ–åä¼šfnä¼šä»…å½“depså‘ç”Ÿå˜åŒ–æ—¶é‡æ–°æ¸²æŸ“, ä¸»è¦ç”¨ä½œç¼“å­˜å‡½æ•° 123456const memoizedCallback = useCallback( () =&gt; { doSomething(a, b); }, [a, b],); 6. ä½¿ç”¨useMemouseMemoä¼šåœ¨æ¸²æŸ“æ—¶è¿è¡Œcallbackå¹¶èµ‹å€¼, ä¸»è¦ç”¨ä½œç¼“å­˜å¤æ‚çš„å‡½æ•°çš„ç»“æœå€¼ 1const memoizedValue = useMemo(() =&gt; computeExpensiveValue(a, b), [a, b]); 7. ä½¿ç”¨useRefuseRefæ˜¯ä¸€ç§ä¸»è¦ç”¨æ¥è®¿é—®Domçš„æ–¹å¼, æ— è®ºèŠ‚ç‚¹å¦‚ä½•å˜åŒ–, å…¶å±æ€§currentä»æŒ‡å‘domèŠ‚ç‚¹ 1const refContainer = useRef(initialValue); 7.1 initialValueæ­¤æ—¶initialValue ç­‰ä»·äºrefContainer.current 7.2 refContainerrefContaineræ˜¯ä¸€ä¸ªmutableçš„ref object, å…¶åœ¨æ•´ä¸ªcomponentç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜ 8. ä½¿ç”¨useImperativeHandleuseImperativeHandle ä¸»è¦ç”¨æ¥æš´éœ²æœ¬èº«componentçš„è‡ªå®šä¹‰å±æ€§ç»™çˆ¶çº§componentä½¿ç”¨ è¯¥ä¾‹å­å±•ç¤ºå¯ä»¥åœ¨çˆ¶çº§ç»„ä»¶ä¸­è°ƒç”¨å­ç»„ä»¶æš´éœ²çš„æ–¹æ³•å’Œå¯¹è±¡: 12345678910111213141516171819202122232425262728293031323334353637import React, { useRef, useEffect, useImperativeHandle, forwardRef} from &quot;react&quot;;import { render } from &quot;react-dom&quot;;const ChildInput = forwardRef((props, ref) =&gt; { const inputRef = useRef(null); useImperativeHandle(ref, () =&gt; ({ ref: inputRef.current, doSomething: console.log })); return &lt;input type=&quot;text&quot; name=&quot;child input&quot; ref={inputRef} /&gt;;});function App() { const inputRef = useRef(null); useEffect(() =&gt; { inputRef.current.ref.focus(); inputRef.current.doSomething(&quot;æ‰“å°&quot;); }, []); return ( &lt;div&gt; &lt;ChildInput ref={inputRef} /&gt; &lt;/div&gt; );}const rootElement = document.getElementById(&quot;root&quot;);render(&lt;App /&gt;, rootElement); 9. ä½¿ç”¨useLayoutEffectuseLayoutEffectæ˜¯ä¸€ç§ç”¨äºåœ¨æµè§ˆå™¨ç»˜åˆ¶å‰åŒæ­¥æ¸²æŸ“é¡µé¢çš„æ–¹æ¡ˆ è¯¥ä¾‹å­å¦‚æœä½¿ç”¨useEffectä»£æ›¿useLayoutEffectåˆ™ä¼šå‡ºç°èŠ‚ç‚¹é—ªçƒçš„æƒ…å†µ: 1234567891011121314151617181920212223242526272829303132333435363738394041import React, { useState, useLayoutEffect, useRef } from &quot;react&quot;;import ReactDOM from &quot;react-dom&quot;;import &quot;./styles.css&quot;;const LayoutEffectComponent = () =&gt; { const [width, setWidth] = useState(0); const [height, setHeight] = useState(0); const el = useRef(); useLayoutEffect(() =&gt; { console.log(&quot;el.current&quot;, el.current.clientWidth); setWidth(el.current.clientWidth); setHeight(el.current.clientHeight); }); return ( &lt;div&gt; &lt;h1&gt;useLayoutEffect Example&lt;/h1&gt; &lt;h2&gt;textarea width: {width}px&lt;/h2&gt; &lt;h2&gt;textarea height: {height}px&lt;/h2&gt; &lt;textarea onClick={() =&gt; { setWidth(0); }} ref={el} /&gt; &lt;/div&gt; );};function App() { return ( &lt;div className=&quot;App&quot;&gt; &lt;LayoutEffectComponent /&gt; &lt;/div&gt; );}const rootElement = document.getElementById(&quot;root&quot;);ReactDOM.render(&lt;App /&gt;, rootElement); 10. ä½¿ç”¨useDebugValueuseDebugValue ç”¨æ¥åœ¨react devToolsä¸­æ˜¾ç¤ºè‡ªå®šä¹‰çš„hookæ ‡ç­¾ 1useDebugValue(value) ğŸ¦„ å®è·µä¾‹å­ä¸‹é¢å±•ç¤ºä¸€ä¸ªç”¨react hooksæ„å»ºtodoåˆ—è¡¨çš„demo: 1. ç»„ä»¶App.js ç»„ä»¶ä¹Ÿå¯ä»¥å†™æˆè‡ªå®šä¹‰æ¨¡å¼useInputForm.js 2. é€»è¾‘æŠ½ç¦»ç›¸å…³é€»è¾‘ä¸ºäº†æ›´å¥½çš„ç»´æŠ¤å’Œå¤ç”¨, çŠ¶æ€ä¸ UI çš„ç•Œé™ä¼šè¶Šæ¥è¶Šæ¸…æ™°useTodo.js å¦ç›¸å…³ä»£ç å·²åŒæ­¥ä¸Gist, ä½¿ç”¨CodeExpanderå³å¯ç”Ÿæˆä»¥ä¸Šä»£ç å›¾ç‰‡. ğŸ²FAQ1. å¯ä»¥åœ¨å‡½æ•°å†…ç›´æ¥å£°æ˜å¸¸é‡æˆ–æ™®é€šå‡½æ•°å—?ä¸å¯ä»¥, è€ƒè™‘æ¯æ¬¡æ¸²æŸ“ä¼šé‡æ–°æ‰§è¡Œ, æ¨èæ”¾åˆ°å‡½æ•°ç»„ä»¶å¤–å±‚é¿å…æ€§èƒ½é—®é¢˜æˆ–ä½¿ç”¨ useCallback å£°æ˜. ğŸ‘»å¸¸ç”¨åº“react-use (æŒç»­æ›´æ–°â€¦)","link":"/posts/426078165.html"},{"title":"åŸºäºPlasmoæ„å»ºç°ä»£æµè§ˆå™¨æ’ä»¶","text":"ä»€ä¹ˆæ˜¯ Chrome extension Background Scripts Content Scripts Popupã€Options Pages Devtools Pagesã€New Tab Pageã€Sandbox Pages The Extension Manifest Understanding the Implications of Manifest v3 Extension and Browser APIs &amp;&amp; Permissions â€¦ ä»€ä¹ˆæ˜¯ Plasmo Example Chrome Extension Plasmo ç®€åŒ–äº†æ„å»ºæµè§ˆå™¨æ‰©å±•çš„è¿‡ç¨‹ï¼Œè®©æ‚¨å¯ä»¥ä¸“æ³¨äºå®ç°é€»è¾‘ã€‚å‘Šåˆ«æ…¢é€Ÿè¿­ä»£ï¼Œè¿æ¥æ›´å¥½çš„å¼€å‘ä½“éªŒ åˆ›å»º1pnpm create plasmo å¼€å‘ä¸æ‰“åŒ…1234567...&quot;scripts&quot;: { &quot;dev&quot;: &quot;plasmo dev&quot;, &quot;build&quot;: &quot;plasmo build&quot;, &quot;zip&quot;: &quot;plasmo build --zip&quot;}... æ”¯æŒ React/Svelte/Vue + Typescript Live-reloading + React HMR Storage API &amp; Messaging API æ”¯æŒ .env* ç¯å¢ƒå˜é‡ è¿œç¨‹ä»£ç æ‰“åŒ… (e.g., for Google Analytics) æ”¯æŒæ‰“åŒ…è·¨æµè§ˆå™¨æ’ä»¶ï¼ŒæŠ¹å¹³manifest.jsonä¹‹é—´å·®å¼‚ åŒ…æ‹¬ Firefox, Edge, Brave, Opera, Safari(å³å°†)ã€‚ ä½¿ç”¨BPPè¿›è¡Œè‡ªåŠ¨å‘å¸ƒ é¡¹ç›®å®è·µï¼šéº»é›€Chromeæ’ä»¶éº»é›€æ˜¯ä¸€æ¬¾åŸºäºchrome extensions Manifest V3æ¥æ„å»ºç®€å•æ˜“ç”¨çš„å½•å±è¯Šæ–­å·¥å…·ã€‚ å®‰è£…ä¸é…ç½®chrome åº”ç”¨å•†åº—ä¸‹è½½åœ°å€ æ•´ä½“æ¡†æ¶æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ é¡¹ç›®ç»“æ„åˆæ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ12345678910111213141516171819202122232425262728293031.â”œâ”€â”€ README.mdâ”œâ”€â”€ assetsâ”‚ â”œâ”€â”€ _locales ---------------------------ã€å¤šè¯­è¨€ã€‘â”‚ â”œâ”€â”€ ...â”‚ â””â”€â”€ icon512.pngâ”œâ”€â”€ package.jsonâ”œâ”€â”€ pnpm-lock.yamlâ”œâ”€â”€ postcss.config.jsâ”œâ”€â”€ srcâ”‚ â”œâ”€â”€ background -------------------------ã€Background Scriptsã€‘â”‚ â”œâ”€â”€ componentsâ”‚ â”œâ”€â”€ contents ---------------------------ã€Content Scriptsã€‘â”‚ â”‚ â”œâ”€â”€ camera.tsxâ”‚ â”‚ â”œâ”€â”€ countdown.tsxâ”‚ â”‚ â”œâ”€â”€ plugins.tsxâ”‚ â”‚ â”œâ”€â”€ root.tsxâ”‚ â”‚ â””â”€â”€ toolbars.tsxâ”‚ â”œâ”€â”€ global.d.tsâ”‚ â”œâ”€â”€ hooksâ”‚ â”œâ”€â”€ imgâ”‚ â”œâ”€â”€ options.tsx ------------------------ã€Options Pagesã€‘â”‚ â”œâ”€â”€ popup.tsx --------------------------ã€Options Pagesã€‘â”‚ â”œâ”€â”€ sandboxes --------------------------ã€Sandbox Pagesã€‘â”‚ â”‚ â””â”€â”€ message.tsâ”‚ â”œâ”€â”€ stylesâ”‚ â”œâ”€â”€ typingsâ”‚ â”œâ”€â”€ utilsâ”‚ â””â”€â”€ webextâ”œâ”€â”€ tailwind.config.jsâ””â”€â”€ tsconfig.json æŠ€æœ¯æ ˆï¼šReact(UI) + Tailwind(CSS) + Recoil(State) + Typescript å½•å±çš„æµç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ getUserMedia è¾“å…¥æºå¯ä»¥æ˜¯ç‰©ç†è®¾å¤‡ï¼Œä¾‹å¦‚éº¦å…‹é£ï¼Œç½‘ç»œæ‘„åƒå¤´æˆ–æ¥è‡ªç”¨æˆ·ç¡¬ç›˜é©±åŠ¨å™¨æˆ–è¿œç¨‹ç½‘ç»œå¯¹ç­‰ä½“çš„æœ¬åœ°æˆ–è¿œç¨‹æ–‡ä»¶, éº¦å…‹é£å¯ä»¥ä»…å‘å°„éŸ³é¢‘æµï¼Œç½‘ç»œæ‘„åƒæœºå¯ä»¥äº§ç”Ÿæ¯”å…¶ä»–è§†é¢‘æµæ›´é«˜åˆ†è¾¨ç‡çš„è§†é¢‘æµã€‚ MediaStreamå¯¹è±¡è¡¨ç¤ºå®æ—¶åª’ä½“æµï¼Œå¹¶å…è®¸åº”ç”¨ç¨‹åºä»£ç è·å–æ•°æ®ï¼Œæ“çºµå•ä¸ªè½¨é“å’ŒæŒ‡å®šè¾“å‡ºã€‚æ‰€æœ‰éŸ³é¢‘å’Œè§†é¢‘å¤„ç†ï¼ˆä¾‹å¦‚å™ªå£°æ¶ˆé™¤ï¼Œå‡è¡¡ï¼Œå›¾åƒå¢å¼ºç­‰ï¼‰éƒ½ç”±éŸ³é¢‘å’Œè§†é¢‘å¼•æ“è‡ªåŠ¨å¤„ç†ã€‚ AudioContext å°†éº¦å…‹é£éŸ³é¢‘ä¸ç½‘é¡µéŸ³é¢‘éœ€è¦ä¸€ä¸ªéŸ³é¢‘ä¸Šä¸‹æ–‡(audio context)ï¼Œ ç„¶åæœ‰ä¸€ä¸ªéŸ³é¢‘æ•°æ®çš„è¾“å…¥(input/source)ï¼Œå†åŠ ä¸Šå¤„ç†ç¨‹åº(process)ï¼Œç„¶åæ˜¯éŸ³é¢‘çš„è¾“å‡º(destination)ï¼Œæœ€åæŠŠä»–ä»¬è¿èµ·æ¥(connection) å¦‚ä½•å®ç° SPARROW å½•å±åŠŸèƒ½ï¼Ÿ å½•å±åŠŸèƒ½ - æ‘„åƒå¤´ç›¸å…³ä»£ç useMediaDevices1const devices = await navigator.mediaDevices.enumerateDevices() useCamera12345678910navigator.mediaDevices .getUserMedia(constraints) .then((stream) =&gt; { if (videoRef.current) { videoRef.current.srcObject = stream } }) .catch((error) =&gt; { logger.error(&quot;ã€æ‘„åƒå¤´ã€‘è·å–å¤±è´¥&quot;, error) }) å½•å±åŠŸèƒ½ - å±å¹•å½•åˆ¶ç›¸å…³ä»£ç useRecord1234567891011121314151617181920212223&lt;!-- è·å– éº¦å…‹é£ --&gt;await navigator.mediaDevices.getUserMedia({ audio: { deviceId } })&lt;!-- åŠ è½½ MediaStream --&gt;const mediaStream = await navigator.mediaDevices.getDisplayMedia({ audio: true, video: videoConfig })const audioCtx = useRef(new AudioContext())audioCtx.current.createMediaStreamSource(mediaStream)&lt;!-- åŠ è½½ MediaRecorder --&gt;mediaStream.current = new MediaStream()mediaRecorder.current = new MediaRecorder( mediaStream.current, mediaConstraints.current)&lt;!-- å½“å€’è®¡æ—¶ç»“æŸæ—¶ --&gt;mediaRecorder.current?.start(1000)&lt;!-- å½“ç»“æŸå½•åˆ¶ --&gt;mediaRecorder.current?.stop() æ—¥å¿—æ•è·æ–¹æ¡ˆé€‰æ‹©ï¼Ÿ é¢å¤–åˆ†äº«ï¼šã€Œèµ°ä¸€èµ°ã€ã€ã€Œæ©¡çš®é¸­ã€ã€ã€Œä»”ç»†é˜…è¯»é”™è¯¯ä¿¡æ¯ã€ã€ã€Œé˜…è¯»æ–‡æ¡£ã€ã€ã€ŒGoogling/StackOverflow/ISSUE/FAQ çš„ç¬¬ä¸€é¡µã€ã€ã€Œæ—¥å¿—å’Œå †æ ˆã€ æ•´ä½“æµç¨‹ Chrome Devtools? è„šæœ¬æ³¨å…¥æ–¹å¼ï¼šconsole, xhr/fetch? Chrome Debugger æ–¹æ¡ˆ æ—¥å¿—æ•è·åŠŸèƒ½ - æµç¨‹å›¾ SPARROW æ—¥å¿—æ•è·åŠŸèƒ½ - æ³¨å†Œåè®®DevTools Protocol1234567891011121314151617181920class Debugger { ... start () { chrome.debugger.onDetach.addListener(this.onDetach) chrome.debugger.onEvent.addListener(this.onEvent) chrome.debugger.attach(this.debuggee, &quot;1.3&quot;, () =&gt; { &lt;!-- ç›‘å¬ç½‘ç»œç›¸å…³ --&gt; chrome.debugger.sendCommand(this.debuggee, &quot;Network.enable&quot;, {}, () =&gt; { // ç¦æ­¢ä½¿ç”¨ç¼“å­˜ chrome.debugger.sendCommand(this.debuggee, &quot;Network.setCacheDisabled&quot;, { cacheDisabled: true }) }) chrome.debugger.sendCommand(this.debuggee, &quot;Page.enable&quot;, {}) &lt;!-- ç›‘å¬æ§åˆ¶å°ç›¸å…³ --&gt; chrome.debugger.sendCommand(this.debuggee, &quot;Runtime.enable&quot;, {}) }) } ... } 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162private onEvent = async ( source: chrome.debugger.Debuggee, method: string, params?: Object ) =&gt; { ... switch (method) { // è·å–æ§åˆ¶å°ä¿¡æ¯ case &quot;Runtime.consoleAPICalled&quot;: this.logEntries.push(params as LogEntry) break case &quot;Runtime.exceptionRevoked&quot;: case &quot;Runtime.exceptionThrown&quot;: this.exceptions.push(params as ExceptionThrownParams) break // è·å–ç½‘ç»œçŠ¶æ€ case &quot;Network.responseReceived&quot;: const responseReceivedParams = params as IResponseReceivedParams this.harEvents.push({ method, params: responseReceivedParams }) break case &quot;Network.loadingFailed&quot;: const loadingFailed = params as ILoadingFailed this.requestFail.set(loadingFailed.requestId, loadingFailed.errorText) this.harEvents.push({ method, params }) break // å¦‚æœè¯·æ±‚æœ€ç»ˆä»ç¼“å­˜ä¸­åŠ è½½ï¼Œåˆ™å¯åŠ¨ case &quot;Network.requestServedFromCache&quot;: const requestServedFromCacheParams = params as IRequestServedFromCache this.harEvents.push({ method, params }) break // å½“é¡µå³å°†å‘é€ HTTP è¯·æ±‚æ—¶è§¦å‘ case &quot;Network.requestWillBeSent&quot;: const requestWillBeSentParams = params as IRequestWillBeSent this.requestWillBeSend.set( requestWillBeSentParams.requestId, requestWillBeSentParams ) this.harEvents.push({ method, params }) break // å½“ HTTP è¯·æ±‚åŠ è½½å®Œæˆæ—¶è§¦å‘ case &quot;Network.loadingFinished&quot;: const loadingFinishedParams = params as INetworkLoadingFinishedParams const loadingFinishedParamsResp = await this.getResponseBody({ requestId: loadingFinishedParams.requestId, resourceType: loadingFinishedParams.type }) if (loadingFinishedParamsResp) { // å­˜å‚¨è¯·æ±‚ä¿¡æ¯ this.requestHasResp.set(loadingFinishedParams.requestId, { body: loadingFinishedParamsResp.body, base64Encoded: loadingFinishedParamsResp.base64Encoded }) } this.harEvents.push({ method, params }) break // å…¶ä½™çš„å°è£…åœ¨ harEvents ä¸­ default: this.harEvents.push({ method, params }) break } ... }","link":"/posts/796073919.html"}],"tags":[{"name":"react","slug":"react","link":"/tags/react/"},{"name":"react hooks","slug":"react-hooks","link":"/tags/react-hooks/"},{"name":"chrome-extension","slug":"chrome-extension","link":"/tags/chrome-extension/"},{"name":"plasmo","slug":"plasmo","link":"/tags/plasmo/"}],"categories":[{"name":"react","slug":"react","link":"/categories/react/"},{"name":"chrome","slug":"chrome","link":"/categories/chrome/"}],"pages":[{"title":"","text":"Hi ğŸ‘‹ My name is DaoLong XuFull Stack Developer ğŸŒ Iâ€™m based in Guangzhou, China ğŸ–¥ï¸ See my portfolio at DaoLong XU Official Website âœ‰ï¸ You can contact me at xudaolong@gmail.com ğŸš€ Iâ€™m currently working on Shopline, JOYY ğŸ§  Iâ€™m learning includes more than just golang, typescript and other related. ğŸ¤ Iâ€™m open to collaborating on chrome extension/electron/golang/websiteâ€¦ Skills Socials BadgesMy GitHub Stats Support Me","link":"/about.html"}]}